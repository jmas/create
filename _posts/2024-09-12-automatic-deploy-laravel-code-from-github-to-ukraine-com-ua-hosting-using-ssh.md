---
title: –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–∏–π –¥–µ–ø–ª–æ–π Laravel –∫–æ–¥—É –∑ Github –Ω–∞ —Ö–æ—Å—Ç—ñ–Ω–≥ –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é SSH
description: –•–æ—á—É –ø–æ–¥—ñ–ª–∏—Ç–∏—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é –¥–ª—è –¥–µ–ø–ª–æ—è –Ω–∞ —Ö–æ—Å—Ç—ñ–Ω–≥
  ukraine.com.ua. –ë–∞–∂–∞–Ω–æ –º–∞—Ç–∏ –±—ñ–∑–Ω–µ—Å-–ø–ª–∞–Ω —Ö–æ—Å—Ç—ñ–Ω–≥—É, –±–æ –Ω–∞ –Ω—å–æ–º—É —î –ø—ñ–¥—Ç—Ä–∏–º–∫–∞
  Supervisor —Ç–∞ NodeJS, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —É —Å–∫—Ä–∏–ø—Ç—ñ, —Ö–æ—á–∞ —ó—Ö –∑–≥–∞–¥—É–≤–∞–Ω–Ω—è –º–æ–∂–Ω–æ
  –ø—Ä–∏–±—Ä–∞—Ç–∏ —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å–∫—Ä–∏–ø—Ç –Ω–∞ –∑–≤–∏—á–∞–π–Ω–æ–º—É —Ö–æ—Å—Ç—ñ–Ω–≥-–ø–ª–∞–Ω—ñ
category: –ü—Ä–æ–≥—Ä–∞–º–º—É–≤–∞–Ω–Ω—è
tags:
  - Github
  - Workflow Actions
date: 2024-09-12T00:00:00.000Z
---
–•–æ—á—É –ø–æ–¥—ñ–ª–∏—Ç–∏—Å—è —Å–∫—Ä–∏–ø—Ç–æ–º, —è–∫–∏–π –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é –¥–ª—è –¥–µ–ø–ª–æ—è –Ω–∞ —Ö–æ—Å—Ç—ñ–Ω–≥ [ukraine.com.ua](https://ukraine.com.ua). –ë–∞–∂–∞–Ω–æ –º–∞—Ç–∏ –±—ñ–∑–Ω–µ—Å-–ø–ª–∞–Ω —Ö–æ—Å—Ç—ñ–Ω–≥—É, –±–æ –Ω–∞ –Ω—å–æ–º—É —î –ø—ñ–¥—Ç—Ä–∏–º–∫–∞ Supervisor —Ç–∞ NodeJS, —è–∫—ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è —É —Å–∫—Ä–∏–ø—Ç—ñ, —Ö–æ—á–∞ —ó—Ö –∑–≥–∞–¥—É–≤–∞–Ω–Ω—è –º–æ–∂–Ω–æ –ø—Ä–∏–±—Ä–∞—Ç–∏ —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Å–∫—Ä–∏–ø—Ç –Ω–∞ –∑–≤–∏—á–∞–π–Ω–æ–º—É —Ö–æ—Å—Ç—ñ–Ω–≥-–ø–ª–∞–Ω—ñ.

## –†–æ–±–æ—Ç–∞, —è–∫—É —Ä–æ–±–∏—Ç—å —Å–∫—Ä–∏–ø—Ç

1. –î–µ–ø–ª–æ—ó—Ç—å –∫–æ–¥ –Ω–∞ —Ö–æ—Å—Ç—ñ–Ω–≥ —á–µ—Ä–µ–∑ SSH
2. –†–æ–±–∏—Ç—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π Composer
3. –†–æ–±–∏—Ç—å –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ª–µ–∂–Ω–æ—Å—Ç–µ–π NPM —Ç–∞ –∑–±—ñ—Ä–∫—É –∞—Å—Å–µ—Ç—ñ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—É—Å–∫ `npm run build`
4. –ó–∞–ø—É—Å–∫–∞—î –º—ñ–≥—Ä–∞—Ü—ñ—ó `php artisan migrate --force`
5. –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞—î –¥–≤–∞ Supervisor –ø—Ä–æ—Ü–µ—Å–∏ Laravel: –ø–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫ (`php artisan schedule:work`) —Ç–∞ –æ–±—Ä–æ–±–Ω–∏–∫ —á–µ—Ä–≥–∏ (`php artisan queue:work`)
6. –í—ñ–¥–ø—Ä–∞–≤–ª—è—î –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —É Telegram –ø—Ä–æ —É—Å–ø—ñ—à–Ω–∏–π –∞–±–æ –Ω–µ —É—Å–ø—ñ—à–Ω–∏–π –¥–µ–ø–ª–æ–π –∑ –ø–æ—Å–∏–ª–∞–Ω–Ω—è–º –Ω–∞ –∫–æ–º—ñ—Ç

## –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ö–æ—Å—Ç—ñ–Ω–≥—É

–í–∞—à —Å–∞–π—Ç –Ω–∞ —Ö–æ—Å—Ç—ñ–Ω–≥—É –º–∞—î –≤–ª–∞—Å–Ω—É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é `/home/USERNAME/WEBSITE/www/` –¥–µ `USERNAME` —Ç–∞ `WEBSITE`—Ü–µ –±—É–¥—É—Ç—å —Å–ø–µ—Ü–∏—Ñ—ñ—á–Ω–∞ –¥–æ –≤–∞—à–æ–≥–æ —Ö–æ—Å—Ç—ñ–Ω–≥—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—è, –∫–æ—Ç—Ä—É –º–æ–∂–Ω–æ –≤–∑—è—Ç–∏ —É —Ä–æ–∑–¥—ñ–ª—ñ —Ö–æ—Å—Ç—ñ–Ω–≥—É _–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–∞–π—Ç—É > –ö–æ—Ä–µ–Ω–µ–≤–∏–π –∫–∞—Ç–∞–ª–æ–≥_.

–ü–æ—Ç—Ä—ñ–±–Ω–æ —á–µ—Ä–µ–∑ SSH —Å—Ç–≤–æ—Ä–∏—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é —Ç–∞ –∫–ª–æ–Ω—É–≤–∞—Ç–∏ Laravel –∫–æ–¥ –∑ Github. –î–ª—è —Ü—å–æ–≥–æ –Ω–µ–æ–±—Ö—ñ–¥–Ω–æ –ø—ñ–¥–∫–ª—é—á–∏—Ç–∏—Å—è –ø–æ SSH –¥–æ —Å–µ—Ä–≤–µ—Ä–∞ —Ö–æ—Å—Ç—ñ–Ω–≥—É —Ç–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ SSH –∫–ª—é—á:

```bash
cd ~/.ssh
ssh-keygen -t rsa -b 2048
cat ~/.ssh/id_rsa.pub
```

–°—Ç–≤–æ—Ä–µ–Ω–∏–π SSH-–∫–ª—é—á –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞—Ç–∏ –≤ —Ä–æ–∑–¥—ñ–ª: [Settings > SSH and GPG keys](https://github.com/settings/keys).

–î–∞–ª—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é –Ω–∞ —Å–µ—Ä–≤–µ—Ä—ñ —Ö–æ—Å—Ç—É–Ω–≥—É –≤ —è–∫–æ–º—É –±—É–¥–µ –∑–Ω–∞—Ö–æ–¥–∏—Ç–∏—Å—è Laravel-–∫–æ–¥ —ñ —Å–∫–ª–æ–Ω—É–≤–∞—Ç–∏ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –∑ Github (—Ç—É—Ç –ø–æ—Ä—Ç—ñ–±–Ω–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ `USERNAME`, `WEBSITE`, `GITHUB_USERNAME`, `GITHUB_REPO` –Ω–∞ –≤–∞—à—ñ –≤–ª–∞—Å–Ω—ñ):

```bash
mkdir /home/USERNAME/WEBSITE/source/
cd /home/USERNAME/WEBSITE/
git clone git@github.com:GITHUB_USERNAME/GITHUB_REPO.git source
```

–î–∞–ª—ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ _–≤–∏–¥–∞–ª–∏—Ç–∏_ –ø–æ—Ç–æ—á–Ω—É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é `www` (–≤—Å—ñ –¥–∞–Ω—ñ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó `www` –±—É–¥—É—Ç—å –≤–∏–¥–∞–ª–µ–Ω—ñ, —Ç–æ–º—É –Ω–µ —Ä–æ–±—ñ—Ç—å —Ü–µ –∑ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—î—é –¥–µ —î —Ü—ñ–Ω–Ω—ñ —Ñ–∞–π–ª–∏) —Ç–∞ –∑–∞–º—ñ–Ω–∏—Ç–∏ —ó—ó –Ω–∞ —Å—ñ–º–ª—ñ–Ω–∫ –Ω–∞ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é `source/public/` (—Ç—É—Ç –ø–æ—Ä—Ç—ñ–±–Ω–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ `USERNAME`, `WEBSITE` –Ω–∞ –≤–∞—à—ñ –≤–ª–∞—Å–Ω—ñ):

```bash
rm -rf /home/USERNAME/WEBSITE/www/
ln -s /home/USERNAME/WEBSITE/source/public /home/USERNAME/WEBSITE/www
```

–ü–µ—Ä–µ–π—Ç–∏ —É —Ä–æ–∑–¥—ñ–ª —Ö–æ—Å—Ç—ñ–Ω–≥—É Supervisor —Ç–∞ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –¥–≤–∞ –ø—Ä–æ—Ü–µ—Å–∏: –ø–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫ (`php artisan schedule:work`), —á–µ—Ä–≥–∏ (`php artisan queue:work`).

–ü—Ä–æ—Ü–µ—Å "–æ–±—Ä–æ–±–Ω–∏–∫ —á–µ—Ä–≥–∏" (—Ç—É—Ç –ø–æ—Ä—Ç—ñ–±–Ω–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ `USERNAME`, `WEBSITE` –Ω–∞ –≤–∞—à—ñ –≤–ª–∞—Å–Ω—ñ):

```bash
cd /home/USERNAME/WEBSITE/source/ && /usr/local/php83/bin/php -c /home/krokom/.system/php/www.WEBSITE.ini artisan queue:work
```

–ü—Ä–æ—Ü–µ—Å "–ø–ª–∞–Ω—É–≤–∞–ª—å–Ω–∏–∫" (—Ç—É—Ç –ø–æ—Ä—Ç—ñ–±–Ω–æ –∑–∞–º—ñ–Ω–∏—Ç–∏ `USERNAME`, `WEBSITE` –Ω–∞ –≤–∞—à—ñ –≤–ª–∞—Å–Ω—ñ):

```bash
cd /home/USERNAME/WEBSITE/source/ && /usr/local/php83/bin/php -c /home/krokom/.system/php/www.WEBSITE.ini artisan schedule:work
```

## –ü—ñ–¥–≥–æ—Ç–æ–≤–∫–∞ —Å–∫—Ä–∏–ø—Ç—É

–í —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—ó —Å—Ç–≤–æ—Ä—é—î–º–æ —Ñ–∞–π–ª `.github/workflows/deploy-ssh.yaml` —ñ –¥–æ–¥–∞—î–º–æ –∑–º—ñ–Ω–Ω—ñ Github Actions –≤ —Ä–æ–∑–¥—ñ–ª—ñ: _–†–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π > Settings > Secrets and variables > Actions_.

–ü–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∑–º—ñ–Ω–Ω—ñ:

* `HOST` ‚Äì —Ö–æ—Å—Ç –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –ø–æ SSH, –º–æ–∂–Ω–æ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –≤ —Ä–æ–∑–¥—ñ–ª—ñ —Ö–æ—Å—Ç—ñ–Ω–≥—É "SSH-–¥–æ—Å—Ç—É–ø"
* `USERNAME` ‚Äì —ñ–º º—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –ø–æ SSH, –º–æ–∂–Ω–æ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –≤ —Ä–æ–∑–¥—ñ–ª—ñ —Ö–æ—Å—Ç—ñ–Ω–≥—É "SSH-–¥–æ—Å—Ç—É–ø"
* `PASSWORD` ‚Äì –ø–∞—Ä–æ–ª—å –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –ø–æ SSH, –º–æ–∂–Ω–æ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –≤ —Ä–æ–∑–¥—ñ–ª—ñ —Ö–æ—Å—Ç—ñ–Ω–≥—É "SSH-–¥–æ—Å—Ç—É–ø"
* `PORT` ‚Äì –ø–æ—Ä—Ç –¥–ª—è –ø—ñ–¥–∫–ª—é—á–µ–Ω–Ω—è –ø–æ SSH, —Ç–µ–∂ –∑ —Ä–æ–∑–¥—ñ–ª—É "SSH-–¥–æ—Å—Ç—É–ø", –∑–∞–∑–≤–∏—á–∞–π 22
* `HOSTING_USERNAME` ‚Äì —Ü–µ —ñ–º º—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ö–æ—Å—Ç—ñ–Ω–≥—É, –º–æ–∂–Ω–æ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –∑ —Ä–æ–∑–¥—ñ–ª—É —Ö–æ—Å—Ç—ñ–Ω–≥–∞ _–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–∞–π—Ç—É > –ö–æ—Ä–µ–Ω–µ–≤–∏–π –∫–∞—Ç–∞–ª–æ–≥_: `/home/USERNAME/WEBSITE/www/`
* `HOSTING_WEBSITE` ‚Äì —Ü–µ —ñ–º º—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ —Ö–æ—Å—Ç—ñ–Ω–≥—É, –º–æ–∂–Ω–æ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è –∑ —Ä–æ–∑–¥—ñ–ª—É —Ö–æ—Å—Ç—ñ–Ω–≥–∞ _–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —Å–∞–π—Ç—É > –ö–æ—Ä–µ–Ω–µ–≤–∏–π –∫–∞—Ç–∞–ª–æ–≥_: `/home/USERNAME/WEBSITE/www/`
* `TELEGRAM_TOKEN` ‚Äì –∫–ª—é—á –¥–æ –≤–∞—à–æ–≥–æ Telegram –±–æ—Ç–∞, —è–∫–∏–π –º–æ–∂–Ω–æ —Å—Ç–≤–æ—Ä–∏—Ç–∏ —á–µ—Ä–µ–∑ –±–æ—Ç [@BotFather](https://t.me/BotFather)
* `TELEGRAM_TO` ‚Äì ID —á–∞—Ç–∞ –¥–ª—è –≤—ñ–¥–ø—Ä–∞–≤–∫–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è, –º–æ–∂–Ω–æ –¥—ñ–∑–Ω–∞—Ç–∏—Å—è —Å–≤—ñ–π ID –≤ –±–æ—Ç—ñ [@getmyid_bot](https://t.me/getmyid_bot), –ø–æ—Ç—ñ–º –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç–∏ —á–∞—Ç –∑ –≤–ª–∞—Å–Ω–∏–º –±–æ—Ç–æ–º

–ö–æ–¥ —Ñ–∞–π–ª—É `.github/workflows/deploy-ssh.yaml`:

{% raw %}
```yaml
name: Deploy SSH

on: [push]

jobs:
  build:
    name: Deploy
    runs-on: ubuntu-latest
    steps:
      - name: Apply changes on server, install deps, migrate, build assets
        uses: appleboy/ssh-action@v1.0.3
        with:
          host: ${{ secrets.HOST }}
          username: ${{ secrets.USERNAME }}
          password: ${{ secrets.PASSWORD }}
          port: ${{ secrets.PORT }}
          script: |
            cd /home/${{ secrets.HOSTING_USERNAME }}/${{ secrets.HOSTING_WEBSITE }}/source
            git stash && git fetch --all && git reset --hard origin/main
            source ~/.bashrc && composer install
            php artisan migrate --force
            pkill -fx '/usr/local/php83/bin/php -c /home/${{ secrets.HOSTING_USERNAME }}/.system/php/www.${{ secrets.HOSTING_WEBSITE }}.ini artisan queue:work'
            pkill -fx '/usr/local/php83/bin/php -c /home/${{ secrets.HOSTING_USERNAME }}/.system/php/www.${{ secrets.HOSTING_WEBSITE }}.ini artisan schedule:work'
            npm ci && npm run build

  notify:
    name: Notify
    runs-on: ubuntu-latest
    if: always()
    needs: [build]
    steps:
      - name: Send status to telegram
        uses: appleboy/telegram-action@master
        with:
          to: ${{ secrets.TELEGRAM_TO }}
          token: ${{ secrets.TELEGRAM_TOKEN }}
          format: "html"
          message: |
            ${{ needs.build.result == 'success' && 'üü¢' || 'üî¥' }} <b>${{ needs.build.result }}</b> <a href="https://github.com/${{ github.repository }}/commit/${{github.sha}}">${{ github.event.commits[0].message }}</a> by <a href="https://github.com/${{ github.actor }}">@${{ github.actor }}</a>
```
{% endraw %}

## –í–∏—Å–Ω–æ–≤–æ–∫

–ü—ñ—Å–ª—è –¥–æ–¥–∞–≤–∞–Ω–Ω—è —Ñ–∞–π–ª—É `deploy-ssh.yaml` —É —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π –ø–æ—á–Ω–µ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ Github Action, –∫–æ—Ç—Ä–∏–π –º–æ–∂–Ω–æ –ø–æ–±–∞—á–∏—Ç–∏ –≤ —Å–µ–∫—Ü—ñ—ó _Github > –í–∞—à —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ–π > Actions_. –ú–æ–∂–Ω–æ –≤—ñ–¥–∫—Ä–∏—Ç–∏ –∑–∞–¥–∞—á—É —Ç–∞ –ø–æ–¥–∏–≤–∏—Ç–∏—Å—è —Å—Ç–∞–Ω –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.

–ö–æ–¥ –ø—Ä–æ—î–∫—Ç—É –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ —Ä–æ–∑–≥–æ—Ä—Ç–∞—î—Ç—å—Å—è –ø—ñ—Å–ª—è –∫–æ–∂–Ω–æ–≥–æ –ø—É—à—É –≤ –≥—ñ–ª–∫—É `main`, –∞ –≤ Telegram –Ω–∞–¥—Ö–æ–¥–∏—Ç—å —Å–ø–æ–≤—ñ—â–µ–Ω–Ω—è, —Ç–æ–∂ —Ç–µ–ø–µ—Ä –º–æ–∂–Ω–æ –∑–Ω–∞—Ç–∏ –ø—Ä–æ –ø–æ—Ç–æ—á–Ω–∏–π —Å—Ç–∞–Ω –∫–æ–∂–Ω–æ–≥–æ –¥–µ–ø–ª–æ—è.
